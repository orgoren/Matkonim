Drop database if exists DbMysql11;
CREATE SCHEMA IF NOT EXISTS DbMysql11;
USE DbMysql11;


CREATE TABLE DbMysql11.ALL_RECIPES(
   recipe_id SMALLINT(5) UNSIGNED NOT NULL,
	recipe_name TEXT(55) NULL DEFAULT NULL,
	picture VARCHAR(2500),
  PRIMARY KEY (recipe_id))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4;


CREATE TABLE DbMysql11.FOOD_RECIPES(
  food_id SMALLINT(5) UNSIGNED NOT NULL,
  recipe_id SMALLINT(5) UNSIGNED NOT NULL,
  prep_time_in_seconds SMALLINT(5) UNSIGNED NOT NULL,
  food_details VARCHAR(2500) NOT NULL,
  FULLTEXT INDEX food_details (food_details), -- ?
  INDEX recipe_id (recipe_id ASC),
  FOREIGN KEY (recipe_id)
  REFERENCES DbMysql11.ALL_RECIPES (recipe_id)
  ON UPDATE CASCADE) 
ENGINE = MyISAM
DEFAULT CHARACTER SET = utf8mb4;


CREATE TABLE DbMysql11.COCKTAIL_RECIPES (
    cocktail_id SMALLINT(5) UNSIGNED NOT NULL,
	recipe_id SMALLINT(5) UNSIGNED NOT NULL,
  cocktail_details VARCHAR(2500) NOT NULL,
  is_alcoholic SMALLINT(1) UNSIGNED NOT NULL,
  INDEX recipe_id (recipe_id ASC),
  FOREIGN KEY (recipe_id)
  REFERENCES DbMysql11.ALL_RECIPES (recipe_id)
  ON UPDATE CASCADE)
ENGINE = MyISAM
DEFAULT CHARACTER SET = utf8mb4;


CREATE TABLE DbMysql11.INGREDIENTS (
    ingredient_id SMALLINT(5) UNSIGNED NOT NULL,
    ingredient_name VARCHAR(55) NOT NULL,
    serving_weight SMALLINT(5) UNSIGNED NOT NULL,
    serving_quantity SMALLINT(2) UNSIGNED NOT NULL,
    serving_unit SMALLINT(2) UNSIGNED NOT NULL,  -- need to check type
   PRIMARY KEY (ingredient_id),
   INDEX ingredient_id (ingredient_id ASC))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4;


CREATE TABLE DbMysql11.RECIPE2INGREDIENTS(
   recipe_id SMALLINT(5) UNSIGNED NOT NULL,
	ingredient_id SMALLINT(5) UNSIGNED NOT NULL,
   amount_in_recipe SMALLINT(2) UNSIGNED NOT NULL,
   quantity SMALLINT(2) UNSIGNED NOT NULL,
   unit VARCHAR(20) NOT NULL,
   full_ingredient_line VARCHAR(90),
   INDEX recipe_id (recipe_id ASC),
   FOREIGN KEY (recipe_id)
   REFERENCES DbMysql11.ALL_RECIPES(recipe_id)
   ON UPDATE CASCADE,
   INDEX ingredient_id (ingredient_id ASC),
   FOREIGN KEY (ingredient_id)
   REFERENCES DbMysql11.INGREDIENTS(ingredient_id)
   ON UPDATE CASCADE)
ENGINE = MyISAM
DEFAULT CHARACTER SET = utf8mb4;


CREATE TABLE DbMysql11.INGREDIENT_NUTIRITION (
    ingredient_name VARCHAR(55) NOT NULL,
	ingredient_id SMALLINT(5) UNSIGNED NOT NULL,
	sugars Float(4) DEFAULT 0,
	iron Float(4) DEFAULT 0,
	calcium Float(4) DEFAULT 0,
	sodium Float(4) DEFAULT 0,
	protein Float(4) DEFAULT 0,
	cholesterol Float(4) DEFAULT 0,
	potassium Float(4) DEFAULT 0,
	lactose Float(4) DEFAULT 0,
	vitaminC Float(4) DEFAULT 0,
	saturated_fat Float(4) DEFAULT 0,
	trans_fat Float(4) DEFAULT 0,
	dietary_fiber Float(4) DEFAULT 0,
	calories Float(4) DEFAULT 0,
	fat Float(4) DEFAULT 0,
	alcoholic Float(4) DEFAULT 0,
   PRIMARY KEY (ingredient_name),
   INDEX ingredient_name (ingredient_name ASC),
   FOREIGN KEY (ingredient_id)
   REFERENCES DbMysql11.INGREDIENTS(ingredient_id)
   ON UPDATE CASCADE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4;


CREATE TABLE DbMysql11.RECOMMEND_BY_AGE_GENDER(
    age SMALLINT(2) UNSIGNED NOT NULL,
	gender BIT(1) NOT NULL, -- 1 for Female, 0 for Male
    ingredient_name VARCHAR(55) NOT NULL,
	sugars Float(4) DEFAULT 0,
	iron Float(4) DEFAULT 0,
	calcium Float(4) DEFAULT 0,
	sodium Float(4) DEFAULT 0,
	protein Float(4) DEFAULT 0,
	cholesterol Float(4) DEFAULT 0,
	potassium Float(4) DEFAULT 0,
	lactose Float(4) DEFAULT 0,
	vitaminC Float(4) DEFAULT 0,
	saturated_fat Float(4) DEFAULT 0,
	trans_fat Float(4) DEFAULT 0,
	dietary_fiber Float(4) DEFAULT 0,
	calories Float(4) DEFAULT 0,
	fat Float(4) DEFAULT 0,
	alcoholic Float(4) DEFAULT 0,
   PRIMARY KEY (age, gender),
   INDEX (age, gender),
   FOREIGN KEY (ingredient_name)
   REFERENCES DbMysql11.INGREDIENT_NUTIRITION(ingredient_name)
   ON UPDATE CASCADE)
ENGINE = MyISAM
DEFAULT CHARACTER SET = utf8mb4;

Insert into DbMysql11.ALL_RECIPES
Values (1, "Test", "Test details");

Insert into DbMysql11.FOOD_RECIPES
Values (11, 1, 2300, "FOOD_TEST");
